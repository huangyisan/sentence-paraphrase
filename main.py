import gradio as gr
from paraphrase.exec import Pegasus
 

if __name__ == '__main__':
    P = Pegasus(num_return_sequences=2, num_beams=2)
    demo = gr.Interface(
        description='''
        ```shell
        ğŸ‰ä½¿ç”¨è¯´æ˜ğŸ‰
        1. num_beams è¯¥æ•°å€¼è¿‡ä½å¯èƒ½ä¼šå¯¼è‡´ç”Ÿæˆçš„ç»“æœä¸åŸæ–‡è¿‡äºç›¸ä¼¼ï¼Œè€Œæ•°å€¼è¿‡é«˜åˆ™å¯èƒ½å¯¼è‡´ç”Ÿæˆçš„ç»“æœåç¦»åŸæ–‡ï¼Œå‡ºç°ä¸å¯é çš„è¾“å‡ºã€‚
        2. num_return_sequences å‚æ•°æ§åˆ¶[å•å¥é€‰æ‹©]ä¸­å¥å­çš„è¾“å‡ºæ•°é‡ã€‚
        3. ä¸¤ä¸ªå‚æ•°çš„å–å€¼èŒƒå›´å‡ä¸º2~20ã€‚æå‡è¿™ä¸¤ä¸ªæ•°å€¼ä¼šè¿›è¡Œæ›´å¤šæ¨æ¼”è®¡ç®—, è€—æ—¶ç›¸å¯¹æ‹‰é•¿ã€‚
        
        â—ï¸æ³¨æ„â—ï¸
        1. ç¨‹åºä¼šå¯¹å¾…é‡å†™å†…å®¹è¿›è¡Œåˆ†å¥, åˆ†å¥ä¾æ®æ˜¯ğŸ‘‰ï¸ä»¥è‹±æ–‡å¤§å†™å­—æ¯, ä¸”ä»¥.?!ç»“å°¾çš„å¥å­ğŸ‘ˆï¸ã€‚ä»¥ä¸‹ä¸ºæ­£ç¡®å’Œé”™è¯¯çš„ä¾‹å­ã€‚
            âœ… "Hello world."
            âŒ "hello world."
        2. åŸæ–‡å¦‚æœ‰å­˜åœ¨æ‹¬å·çš„å†…å®¹, éœ€è¦åæœŸæ‰‹å·¥è¡¥å…¨ã€‚
        3. ç¨‹åºä¼šé€ä¸€å¯¹å¥å­è¿›è¡Œé‡å†™, å¹¶é€‰å–æœ€é•¿çš„å¥å­ä½œä¸ºæœ€ç»ˆè¾“å‡ºã€‚å…¶ä»–å€™é€‰å¥å­å‡ä¼šåœ¨[å•å¥é€‰æ‹©]è¾“å‡ºç»“æœä¸­å±•ç¤ºã€‚

        ```
        ''',
        fn=P.exec, 
        inputs=[
            gr.Textbox(label="å¾…é‡å†™å†…å®¹", placeholder="è¾“å…¥æˆ–ç²˜è´´æ‚¨è¦é‡å†™çš„å†…å®¹, å¹¶æŒ‰æäº¤æŒ‰é’®"), 
            gr.Slider(value=5, minimum=2, maximum=20, step=1, label="num_beams"),
            gr.Slider(value=4, minimum=2, maximum=20, step=1, label="num_return_sequences")], 
        outputs=[
            gr.Textbox(label="é‡å†™ç»“æœ", placeholder="è¿™é‡ŒæŸ¥çœ‹æœ€ç»ˆçš„è¾“å‡ºç»“æœ"), 
            gr.Textbox(label="å•å¥ç»“æœ", placeholder="è¿™é‡ŒæŸ¥çœ‹å•å¥æ‰€æœ‰è¾“å‡ºç»“æœ")
            ],
        
        submit_btn="æäº¤",
        clear_btn="æ¸…ç©º",
        allow_flagging = "never"
        )
    demo.launch(server_port=7880)